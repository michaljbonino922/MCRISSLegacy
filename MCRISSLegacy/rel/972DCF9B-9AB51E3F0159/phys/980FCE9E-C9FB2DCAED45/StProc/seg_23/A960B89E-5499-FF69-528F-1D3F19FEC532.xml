<?xml version = '1.0' encoding = 'UTF-8'?>
<StoredProcedureSqlServerv2k5 class="oracle.dbtools.crest.model.design.storage.sqlserver.v2k5.StoredProcedureSqlServerv2k5" name="[sp_ODSE_ImportToMarine]" directorySegmentName="seg_23" id="A960B89E-5499-FF69-528F-1D3F19FEC532">
<sourceDDLFile>Appian.sql</sourceDDLFile>
<createdBy>MichalBonino</createdBy>
<createdTime>2024-04-29 23:57:48 UTC</createdTime>
<ownerDesignName>MCRISSLegacy</ownerDesignName>
<body><![CDATA[AS 
 
-- Update Marine table  
UPDATE MARINE 
SET  
 PRESENT_GRADE_CODE=OI.PRESENT_GRADE_CODE, 
 COMPONENT_CODE=OI.COMPONENT_CODE, 
 LAST_MONITORED_COMMAND_CODE=OI.LAST_MONITORED_COMMAND_CODE, 
 LAST_TRANSFER_REPORT_UNIT_CODE=OI.LAST_TRANSFER_REPORT_UNIT_CODE, 
 LAST_MONITOR_CMD_DETACH_DATE=OI.LAST_MONITOR_CMD_DETACH_DATE, 
 PRESENT_UNIT_JOINED_DATE=OI.PRESENT_UNIT_JOINED_DATE, 
 CURRENT_TOUR_BEGIN_DATE=OI.CURRENT_TOUR_BEGIN_DATE, 
 COMPANY_CODE=OI.COMPANY_CODE, 
 PLATOON_NUMBER=OI.PLATOON_NUMBER, 
 PRESENT_MONITORED_COMMAND_CODE=OI.PRESENT_MONITORED_COMMAND_CODE, 
 PRESENT_REPORTING_UNIT_CODE=OI.PRESENT_REPORTING_UNIT_CODE, 
 ESTIMATED_DEPARTURE_DATE=OI.ESTIMATED_DEPARTURE_DATE, 
 FUTURE_MONITORED_COMMAND_CODE=OI.FUTURE_MONITORED_COMMAND_CODE, 
 FUTURE_REPORTING_UNIT_CODE=OI.FUTURE_REPORTING_UNIT_CODE, 
 LAST_TRANSFER_ACTION_DATE=OI.LAST_TRANSFER_ACTION_DATE, 
 BILLET_MOS=OI.BILLET_MOS, 
 PRIMARY_MOS=OI.PRIMARY_MOS_CODE, 
 RECORD_STATUS=OI.RECORD_STATUS_CODE, 
 EXPIRATION_OF_CURRENT_CONTRACT=OI.EXPIRATION_OF_CURRENT_CONTRACT, 
 EXPIRATION_OF_ACTIVE_SERVICE=OI.EXPIRATION_OF_ACTIVE_SERVICE, 
 USER_LOGIN='MCMODSINTERFACE', 
 UPDATE_DATE=GETDATE(), 
 RESERVE_REPORTING_UNIT_CODE=OI.RESERVE_REPORTING_UNIT_CODE, 
 CURRENT_ACTIVE_DUTY_BEGAN_DATE=OI.CURRENT_ACTIVE_DUTY_BEGAN_DATE, 
 BILLET_DESCRIPTION=OI.BILLET_DESCRIPTION 
FROM  
 ODSE_IMPORT OI 
 INNER JOIN PERSON P ON (RIGHT(OI.SSN,9)=P.SOCIAL_SECURITY_NUMBER) 
 INNER JOIN MARINE M ON (M.MARINE_ID=P.PERSON_ID) 
 
--INSERT INTO MARINE TABLE 
INSERT INTO MCRISS.DBO.MARINE 
( 
 MARINE_ID, 
 PRESENT_GRADE_CODE, 
 COMPONENT_CODE, 
 LAST_MONITORED_COMMAND_CODE, 
 LAST_TRANSFER_REPORT_UNIT_CODE, 
 LAST_MONITOR_CMD_DETACH_DATE, 
 PRESENT_UNIT_JOINED_DATE, 
 CURRENT_TOUR_BEGIN_DATE, 
 COMPANY_CODE, 
 PLATOON_NUMBER, 
 PRESENT_MONITORED_COMMAND_CODE, 
 PRESENT_REPORTING_UNIT_CODE, 
 ESTIMATED_DEPARTURE_DATE, 
 FUTURE_MONITORED_COMMAND_CODE, 
 FUTURE_REPORTING_UNIT_CODE, 
 LAST_TRANSFER_ACTION_DATE, 
 BILLET_MOS, 
 PRIMARY_MOS, 
 RECORD_STATUS, 
 EXPIRATION_OF_CURRENT_CONTRACT, 
 EXPIRATION_OF_ACTIVE_SERVICE, 
 USER_LOGIN, 
 UPDATE_DATE, 
 RESERVE_REPORTING_UNIT_CODE, 
 CURRENT_ACTIVE_DUTY_BEGAN_DATE, 
 BILLET_DESCRIPTION 
) 
SELECT 
 P.PERSON_ID,  
 OI.PRESENT_GRADE_CODE, 
 OI.COMPONENT_CODE, 
 OI.LAST_MONITORED_COMMAND_CODE, 
 OI.LAST_TRANSFER_REPORT_UNIT_CODE, 
 OI.LAST_MONITOR_CMD_DETACH_DATE, 
 OI.PRESENT_UNIT_JOINED_DATE, 
 OI.CURRENT_TOUR_BEGIN_DATE, 
 OI.COMPANY_CODE, 
 OI.PLATOON_NUMBER, 
 OI.PRESENT_MONITORED_COMMAND_CODE, 
 OI.PRESENT_REPORTING_UNIT_CODE, 
 OI.ESTIMATED_DEPARTURE_DATE, 
 OI.FUTURE_MONITORED_COMMAND_CODE, 
 OI.FUTURE_REPORTING_UNIT_CODE, 
 OI.LAST_TRANSFER_ACTION_DATE, 
 OI.BILLET_MOS, 
 OI.PRIMARY_MOS_CODE, 
 OI.RECORD_STATUS_CODE, 
 OI.EXPIRATION_OF_CURRENT_CONTRACT, 
 OI.EXPIRATION_OF_ACTIVE_SERVICE, 
 'MCMODSINTERFACE', 
 GETDATE(), 
 OI.RESERVE_REPORTING_UNIT_CODE, 
 OI.CURRENT_ACTIVE_DUTY_BEGAN_DATE, 
 OI.BILLET_DESCRIPTION  
FROM  
 ODSE_IMPORT OI  
 JOIN PERSON P ON (RIGHT(OI.SSN,9)=P.SOCIAL_SECURITY_NUMBER) 
WHERE  
 P.PERSON_ID NOT IN (SELECT MARINE_ID FROM MARINE)]]></body>
<schema>DD6CF638-A2EB-2E1B-FF13-422CA718DE2D</schema>
<database>EA42DEDC-DFC5-B775-3079-AD0E133F5E1D</database>
</StoredProcedureSqlServerv2k5>