<?xml version = '1.0' encoding = 'UTF-8'?>
<StoredProcedureSqlServerv2k5 class="oracle.dbtools.crest.model.design.storage.sqlserver.v2k5.StoredProcedureSqlServerv2k5" name="[sp_GetAc.vityObjec.ves]" directorySegmentName="seg_16" id="3EBFC5D8-580F-1D6A-04AA-38C6B87F4668">
<sourceDDLFile>Appian.sql</sourceDDLFile>
<createdBy>MichalBonino</createdBy>
<createdTime>2024-04-29 23:57:47 UTC</createdTime>
<ownerDesignName>MCRISSLegacy</ownerDesignName>
<body><![CDATA[@Organiza.onID int,  
 @FiscalYear  int,  
 @Month   int, 
 @OrgType varchar(7) 
AS 
 
DECLARE @MissionValue int 
 
IF @OrgType = 'RS' 
 BEGIN 
 SET @MissionValue = (SELECT SUM(MISSION_VALUE) FROM CONTRACTING_MISSION_PLAN CMP INNER JOIN 
    RECRUITING_ORGANIZATION RO ON CMP.ORGANIZATION_ID = RO.ORGANIZATION_ID 
    INNER JOIN ORGANIZATION_MAP OM ON CMP.ORGANIZATION_ID = OM.CHILD_ORGANIZATION_ID 
    WHERE OM.PARENT_ORGANIZATION_ID = @Organiza.onID AND 
    CMP.CONTRACTING_MISSION_TYPE = 'RS' AND 
    CMP.FISCAL_YEAR = @FiscalYear AND 
    CMP.MONTH_CODE = @Month AND 
    RO.ORGANIZATION_TYPE = 'RSS') 
 END 
 
IF @OrgType = 'RSS' Or @OrgType = 'NEW RSS' 
 BEGIN 
 SET @MissionValue = (SELECT MISSION_VALUE FROM CONTRACTING_MISSION_PLAN CMP  
    INNER JOIN RECRUITING_ORGANIZATION RO ON CMP.ORGANIZATION_ID = RO.ORGANIZATION_ID  
    WHERE CMP.ORGANIZATION_ID = @Organiza.onID AND 
    CMP.FISCAL_YEAR = @FiscalYear AND 
    CMP.MONTH_CODE = @Month AND 
    CMP.CONTRACTING_MISSION_TYPE = 'RS' AND 
    RO.ORGANIZATION_TYPE = 'RSS') 
 END  
 
/* 
IF @OrgType = 'NEW RSS' 
 BEGIN 
 
 DECLARE @NumRSSs  decimal 
 DECLARE @TotalMissionValue  int 
 DECLARE @AVG   decimal (4, 1) 
 
 SET @TotalMissionValue = (SELECT SUM(MISSION_VALUE) FROM CONTRACTING_MISSION_PLAN CMP INNER JOIN 
    RECRUITING_ORGANIZATION RO ON CMP.ORGANIZATION_ID = RO.ORGANIZATION_ID 
    INNER JOIN ORGANIZATION_MAP OM ON CMP.ORGANIZATION_ID = OM.CHILD_ORGANIZATION_ID 
    WHERE OM.PARENT_ORGANIZATION_ID = (SELECT OM2.PARENT_ORGANIZATION_ID FROM ORGANIZATION_MAP OM2  
        WHERE OM2.CHILD_ORGANIZATION_ID = @Organiza.onID) AND 
    CMP.CONTRACTING_MISSION_TYPE = 'RS' AND 
    CMP.FISCAL_YEAR = @FiscalYear AND 
    CMP.MONTH_CODE = @Month AND 
    RO.ORGANIZATION_TYPE = 'RSS') 
 
 SET @NumRSSs = (SELECT COUNT(RO.ORGANIZATION_ID) FROM RECRUITING_ORGANIZATION RO  
   INNER JOIN ORGANIZATION_MAP OM ON RO.ORGANIZATION_ID = OM.CHILD_ORGANIZATION_ID 
   WHERE OM.PARENT_ORGANIZATION_ID = (SELECT OM2.PARENT_ORGANIZATION_ID FROM ORGANIZATION_MAP OM2 
   WHERE OM2.CHILD_ORGANIZATION_ID = @Organiza.onID) AND 
   RO.ORGANIZATION_TYPE = 'RSS' AND 
   RO.ISOPEN = 'Y') 
 
 IF @TotalMissionValue IS NULL SET @TotalMissionValue = 0 
 
 IF @NumRSSs > 0  
  BEGIN 
  SET @AVG = @TotalMissionValue/@NumRSSs 
  END 
 ELSE 
  BEGIN 
  --- MAY NEED TO RAISE ERROR IF THIS HAPPENS  
  SET @AVG = 0 
  END 
 
 --- ROUND THE AVERAGE UP AND RETURN THE MISSION VALUE 
 SET @MissionValue = CEILING(@AVG) 
  
 END 
*/ 
IF @MissionValue IS NULL SET @MissionValue = 0 
 
-- Added AO_CONTRACT_OBJECTIVE to Select Statment to compare to CONTRACT_OBJECTIVE per SCR # 588 
SELECT  
 @MissionValue AS CONTRACT_OBJECTIVE, 
 AO.NWAS_OBJECTIVE, AO.INTERVIEWS_OBJECTIVE,  
 AO.TCS_OBJECTIVE, AO.OTS_OBJECTIVE, AO.ACS_OBJECTIVE, AO.HVS_OBJECTIVE,  
 AO.WORK_DAYS, AO.CONTRACT_OBJECTIVE AS AO_CONTRACT_OBJECTIVE 
FROM  
 ACTIVITY_OBJECTIVE AO  
WHERE  
 AO.ORGANIZATION_ID = @Organiza.onID AND 
 AO.FISCAL_YEAR = @FiscalYear AND 
 AO.MONTH = @Month]]></body>
<schema>DD6CF638-A2EB-2E1B-FF13-422CA718DE2D</schema>
<database>EA42DEDC-DFC5-B775-3079-AD0E133F5E1D</database>
</StoredProcedureSqlServerv2k5>