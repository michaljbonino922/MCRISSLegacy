<?xml version = '1.0' encoding = 'UTF-8'?>
<StoredProcedureSqlServerv2k5 class="oracle.dbtools.crest.model.design.storage.sqlserver.v2k5.StoredProcedureSqlServerv2k5" name="[sp_GetMUDReAc.vateZips]" directorySegmentName="seg_18" id="DA3073E4-59BC-452B-8DA0-34ACC20A2371">
<sourceDDLFile>Appian.sql</sourceDDLFile>
<createdBy>MichalBonino</createdBy>
<createdTime>2024-04-29 23:57:48 UTC</createdTime>
<ownerDesignName>MCRISSLegacy</ownerDesignName>
<body><![CDATA[AS 
 
 
SET NOCOUNT ON 
 
--- SELECT WHICH ZIPCODES ARE MARKED ARCHIVED IN THE CURRENT SYSTEM BUT ARE NOW ACTIVE ACCORDING 
--- TO THE QUARTERLY UPDATE 
DECLARE @RecordsToReac.vate int 
 
SET @RecordsToReac.vate = (SELECT COUNT(*) FROM MUD_FILE MF WHERE EXISTS (SELECT 1 FROM MUD_STAGING MS WHERE MS.ZIP = MF.ZIP AND MF.STATUS_ID = 'R')) 
 
IF @RecordsToReac.vate > 0 
 BEGIN 
  
 --- STORE ZIPCODES TO BE REACTIVATED 
 INSERT INTO MUD_REACTIVATE_ZIPCODES(ZIP,FIPS,STATE,COUNTY,LAT,LONG,NOTIFY_FLAG,USER_LOGIN,UPDATE_DATE) 
 SELECT  
  MF.ZIP, 
  MF.FIPS, 
  MF.STATE, 
  MF.COUNTY, 
  MF.LAT, 
  MF.LONG, 
  0 AS NOTIFY_FLAG, 
  'SA' AS USER_LOGIN, 
  GETDATE() AS UPDATE_DATE 
 FROM MUD_FILE MF WHERE EXISTS (SELECT 1 FROM MUD_STAGING MS WHERE MS.ZIP = MF.ZIP AND MF.STATUS_ID = 'R') AND 
 NOT EXISTS (SELECT 1 FROM MUD_REACTIVATE_ZIPCODES MA WHERE MF.ZIP = MA.ZIP) 
 
 END 
 
 
SET NOCOUNT OFF]]></body>
<schema>DD6CF638-A2EB-2E1B-FF13-422CA718DE2D</schema>
<database>EA42DEDC-DFC5-B775-3079-AD0E133F5E1D</database>
</StoredProcedureSqlServerv2k5>