<?xml version = '1.0' encoding = 'UTF-8'?>
<StoredProcedureSqlServerv2k5 class="oracle.dbtools.crest.model.design.storage.sqlserver.v2k5.StoredProcedureSqlServerv2k5" name="[sp_GetOCSHistory]" directorySegmentName="seg_19" id="1D8D8C67-578E-4330-F05E-47C557B00307">
<sourceDDLFile>Appian.sql</sourceDDLFile>
<createdBy>MichalBonino</createdBy>
<createdTime>2024-04-29 23:57:48 UTC</createdTime>
<ownerDesignName>MCRISSLegacy</ownerDesignName>
<body><![CDATA[@NWAID int 
AS 
 
SELECT 
 O.OCS_ID, 
 COALESCE(CONVERT(VARCHAR(11), O.SCHEDULED_SHIP_DATE, 106), 'NOT SCHEDULED YET') AS SCHEDULED_SHIP_DATE, 
 C.TRAINING_TYPE_CODE AS TRAINING_TYPE, 
 C.CLASS_NUMBER, 
 C.TRAINING_TYPE_CODE, 
 C.CLASS_NUMBER AS CLASS_INCREMENT, 
 CONVERT(CHAR(11), O.REPORT_DATE, 106) AS REPORT_DATE, 
 R.RESULT_DESCRIPTION, 
 COALESCE(CONVERT(VARCHAR(2), O.TRAINING_DROP_WEEK), SPACE(0)) AS TRAINING_DROP_WEEK 
FROM 
 OCS O INNER JOIN OCS_CLASS C ON  
  (O.OCS_CLASS_ID = C.CLASS_ID AND 
  O.NWA_ID = @NWAID AND 
  (O.DISPLAY_RECORD = 'Y' OR 
  C.TRAINING_TYPE_CODE = 'PLCSR' AND  
  EXISTS (SELECT 1 FROM OCS O1 INNER JOIN OCS_CLASS C1 ON  
    (O1.OCS_CLASS_ID = C1.CLASS_ID AND  
    O1.NWA_ID = @NWAID AND 
    C1.TRAINING_TYPE_CODE = 'PLCJR' AND 
    O1.DISPLAY_RECORD = 'Y' AND 
    O1.OCS_ID < O.OCS_ID))))  
 LEFT OUTER JOIN OCS_CLASS_RESULT R ON O.CLASS_RESULT_CODE = R.RESULT_CODE 
ORDER BY  
 O.OCS_ID DESC]]></body>
<schema>DD6CF638-A2EB-2E1B-FF13-422CA718DE2D</schema>
<database>EA42DEDC-DFC5-B775-3079-AD0E133F5E1D</database>
</StoredProcedureSqlServerv2k5>