<?xml version = '1.0' encoding = 'UTF-8'?>
<StoredProcedureSqlServerv2k5 class="oracle.dbtools.crest.model.design.storage.sqlserver.v2k5.StoredProcedureSqlServerv2k5" name="[GetMonthlyAc.vityReportMissionRow]" directorySegmentName="seg_6" id="5F513403-1757-2E80-76C4-AD7533628F5C">
<sourceDDLFile>create MCRISS script - MCRISS OTA.txt</sourceDDLFile>
<createdBy>MichalBonino</createdBy>
<createdTime>2024-04-29 19:28:42 UTC</createdTime>
<ownerDesignName>MCRISSLegacy</ownerDesignName>
<body><![CDATA[@ORG_ID int, 
 @MISSION_FISCAL_YEAR int 
AS 
BEGIN 
 
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED 
 
Declare @MISSION_FISCAL_YEAR_PLUS1 int 
Declare @MISSION_FISCAL_YEAR_PLUS2 int 
Declare @MISSION_FISCAL_YEAR_PLUS3 int 
Declare @OCC_FIRST_CLASS_NUMBER int 
Declare @OCC_SECOND_CLASS_NUMBER int 
Declare @OCC_THIRD_CLASS_NUMBER int 
 
set @MISSION_FISCAL_YEAR_PLUS1 = @MISSION_FISCAL_YEAR + 1; 
set @MISSION_FISCAL_YEAR_PLUS2 = @MISSION_FISCAL_YEAR + 2; 
set @MISSION_FISCAL_YEAR_PLUS3 = @MISSION_FISCAL_YEAR + 3; 
 
set @OCC_FIRST_CLASS_NUMBER = ( 
 select min(CLASS_NUMBER) from dbo.OCS_CLASS  
 where FISCAL_YEAR = @MISSION_FISCAL_YEAR and  
    TRAINING_TYPE_CODE = 'OCC') 
set @OCC_SECOND_CLASS_NUMBER = @OCC_FIRST_CLASS_NUMBER + 1; 
set @OCC_THIRD_CLASS_NUMBER = @OCC_FIRST_CLASS_NUMBER + 2; 
 
select  PLC1.PLC1_GROUND, 
  PLC1.PLC1_NFO, 
  PLC1.PLC1_AIR, 
  PLC1.PLC1_LAW1, 
  PLC1.PLC1_TOTAL, 
   
  PLC2.PLC2_GROUND, 
  PLC2.PLC2_NFO, 
  PLC2.PLC2_AIR, 
  PLC1.PLC1_LAW2, 
  PLC2.PLC2_TOTAL, 
 
  PLC3.PLC3_GROUND, 
  PLC3.PLC3_NFO, 
  PLC3.PLC3_AIR, 
  PLC1.PLC1_LAW3, 
  PLC3.PLC3_TOTAL, 
 
  OCC1.OCC1_GROUND, 
  OCC1.OCC1_NFO, 
  OCC1.OCC1_AIR, 
  OCC1.OCC1_LAW, 
  OCC1.OCC1_TOTAL, 
  OCC1.OCCR1_GROUND, 
   
  OCC2.OCC2_GROUND, 
  OCC2.OCC2_NFO, 
  OCC2.OCC2_AIR, 
  OCC2.OCC2_LAW, 
  OCC2.OCC2_TOTAL, 
  OCC2.OCCR2_GROUND, 
 
  OCC3.OCC3_GROUND, 
  OCC3.OCC3_NFO, 
  OCC3.OCC3_AIR, 
  OCC3.OCC3_LAW, 
  OCC3.OCC3_TOTAL, 
  OCC3.OCCR3_GROUND 
from  
----------------------------------------- PLC ------------------------------------------ 
(select GROUND_MISSION PLC1_GROUND, NFO_MISSION PLC1_NFO, NAVAL_AIR_MISSION PLC1_AIR, LAW1_MISSION PLC1_LAW1, LAW2_MISSION PLC1_LAW2, LAW3_MISSION PLC1_LAW3, 
        (BLACK_MISSION + HISPANIC_MISSION + OTHER_MISSION + FEMALE_MISSION) PLC1_TOTAL 
from dbo.OFFICER_SHIP_MISSION_PLAN 
where ORGANIZATION_ID = @ORG_ID and FISCAL_YEAR = @MISSION_FISCAL_YEAR and GRAD_YEAR = @MISSION_FISCAL_YEAR_PLUS1) PLC1, 
 
(select GROUND_MISSION PLC2_GROUND, NFO_MISSION PLC2_NFO, NAVAL_AIR_MISSION PLC2_AIR, 
        (BLACK_MISSION + HISPANIC_MISSION + OTHER_MISSION + FEMALE_MISSION) PLC2_TOTAL 
from dbo.OFFICER_SHIP_MISSION_PLAN 
where ORGANIZATION_ID = @ORG_ID and FISCAL_YEAR = @MISSION_FISCAL_YEAR and GRAD_YEAR = @MISSION_FISCAL_YEAR_PLUS2) PLC2, 
 
(select GROUND_MISSION PLC3_GROUND, NFO_MISSION PLC3_NFO, NAVAL_AIR_MISSION PLC3_AIR, 
        (BLACK_MISSION + HISPANIC_MISSION + OTHER_MISSION + FEMALE_MISSION) PLC3_TOTAL 
from dbo.OFFICER_SHIP_MISSION_PLAN 
where ORGANIZATION_ID = @ORG_ID and FISCAL_YEAR = @MISSION_FISCAL_YEAR and GRAD_YEAR = @MISSION_FISCAL_YEAR_PLUS3) PLC3, 
----------------------------------------- OCC ------------------------------------------ 
(select GROUND_MISSION OCC1_GROUND, NFO_MISSION OCC1_NFO, NAVAL_AIR_MISSION OCC1_AIR, LAW1_MISSION OCC1_LAW, 
        (BLACK_MISSION + HISPANIC_MISSION + OTHER_MISSION + FEMALE_MISSION) OCC1_TOTAL, 
        OCCR_GROUND_MISSION OCCR1_GROUND 
from dbo.OFFICER_SHIP_MISSION_PLAN 
where ORGANIZATION_ID = @ORG_ID and OCC_CLASS_NUMBER = @OCC_FIRST_CLASS_NUMBER) OCC1, 
 
(select GROUND_MISSION OCC2_GROUND, NFO_MISSION OCC2_NFO, NAVAL_AIR_MISSION OCC2_AIR, LAW1_MISSION OCC2_LAW, 
        (BLACK_MISSION + HISPANIC_MISSION + OTHER_MISSION + FEMALE_MISSION) OCC2_TOTAL, 
        OCCR_GROUND_MISSION OCCR2_GROUND 
from dbo.OFFICER_SHIP_MISSION_PLAN 
where ORGANIZATION_ID = @ORG_ID and OCC_CLASS_NUMBER = @OCC_SECOND_CLASS_NUMBER) OCC2, 
 
(select GROUND_MISSION OCC3_GROUND, NFO_MISSION OCC3_NFO, NAVAL_AIR_MISSION OCC3_AIR, LAW1_MISSION OCC3_LAW, 
        (BLACK_MISSION + HISPANIC_MISSION + OTHER_MISSION + FEMALE_MISSION) OCC3_TOTAL, 
        OCCR_GROUND_MISSION OCCR3_GROUND 
from dbo.OFFICER_SHIP_MISSION_PLAN 
where ORGANIZATION_ID = @ORG_ID and OCC_CLASS_NUMBER = @OCC_THIRD_CLASS_NUMBER) OCC3 
 
END]]></body>
<schema>72379847-5555-B149-4E45-17F849103A51</schema>
<database>B007042D-D2E3-F83F-481F-CEB23B21CB30</database>
</StoredProcedureSqlServerv2k5>