<?xml version = '1.0' encoding = 'UTF-8'?>
<StoredProcedureSqlServerv2k5 class="oracle.dbtools.crest.model.design.storage.sqlserver.v2k5.StoredProcedureSqlServerv2k5" name="[GetCommissioneeView]" directorySegmentName="seg_4" id="10B9520C-9FD4-F753-E327-C91979FAF3ED">
<sourceDDLFile>Appian.sql</sourceDDLFile>
<createdBy>MichalBonino</createdBy>
<createdTime>2024-04-29 23:57:48 UTC</createdTime>
<ownerDesignName>MCRISSLegacy</ownerDesignName>
<body><![CDATA[@FromDate date.me, 
 @ToDate  date.me, 
 @OSS  int = NULL, 
 @SortExpression nvarchar(100) = 'CommissionDate' 
AS 
 
SELECT      
 P.PERSON_ID,  
 N.NWA_ID,  
 OC.CONTRACT_ID,  
 C.COMMISSIONEE_ID,  
 P.LAST_NAME + ', ' + P.FIRST_NAME + COALESCE (SPACE(1)  
                      + P.LEGAL_MIDDLE_NAME, SPACE(0)) AS PERSON_NAME,  
    P.SOCIAL_SECURITY_NUMBER AS SSN,  
    MC.GENDER_CODE AS GENDER,  
    C.COMMISSION_DATE,  
    dbo.TBS.CLASS AS TBS_CLASS,  
    dbo.TBS.FY AS TBS_FY,  
    SD.STATUS_DESCRIPTION AS STATUS, 
    SD.DISPOSITION_DESCRIPTION AS DISPOSITION, 
 OSS.ORGANIZATION_ID AS Organiza.onOfRecordID,  
 OSS.SHORT_NAME AS Organiza.onOfRecordName    
FROM          
 dbo.COMMISSIONEE AS C WITH (NOLOCK) INNER JOIN 
 dbo.OFFICER_CONTRACT AS OC ON C.CONTRACT_ID = OC.CONTRACT_ID AND  
          C.COMMISSION_DATE BETWEEN @FromDate AND @ToDate INNER JOIN 
 dbo.NWA AS N ON OC.NWA_ID = N.NWA_ID AND N.ORGANIZATION_OF_RECORD_ID = @OSS INNER JOIN 
 dbo.RECRUITING_ORGANIZATION OSS ON N.ORGANIZATION_OF_RECORD_ID = OSS.ORGANIZATION_ID INNER JOIN 
    dbo.PERSON AS P ON N.MARINE_CANDIDATE_ID = P.PERSON_ID INNER JOIN 
    dbo.MARINE_CANDIDATE AS MC ON P.PERSON_ID = MC.MARINE_CANDIDATE_ID INNER JOIN 
    dbo.CANDIDATE_STATUS AS CS ON N.NWA_ID = CS.NWA_ID AND  
          CS.STATUS_TYPE = 'O' AND  
          CS.CANDIDATE_STATUS_ID = USMC.GetMaxStatusID(CS.NWA_ID) INNER JOIN 
 dbo.STATUS_DISPOSITION AS SD ON CS.STATUS_TYPE = SD.STATUS_TYPE AND  
         CS.STATUS_CODE = SD.STATUS_CODE AND  
         CS.DISPOSITION_CODE = SD.DISPOSITION_CODE LEFT OUTER JOIN 
 dbo.PRECOMMISSION_DATA AS PCD ON OC.NWA_ID = PCD.NWA_ID LEFT OUTER JOIN 
 dbo.TBS ON PCD.TBS_ID = dbo.TBS.TBS_ID 
ORDER BY 
CASE WHEN @SortExpression='PersonName' THEN P.LAST_NAME + ', ' + P.FIRST_NAME END ASC, 
CASE WHEN @SortExpression='PersonName DESC' THEN P.LAST_NAME + ', ' + P.FIRST_NAME END DESC, 
CASE WHEN @SortExpression='CommissionDate' THEN C.COMMISSION_DATE END ASC, 
CASE WHEN @SortExpression='CommissionDate DESC' THEN C.COMMISSION_DATE END DESC, 
CASE WHEN @SortExpression='TBSClass' THEN dbo.TBS.CLASS END ASC, 
CASE WHEN @SortExpression='TBSClass DESC' THEN dbo.TBS.CLASS END DESC, 
CASE WHEN @SortExpression='TBSFY' THEN dbo.TBS.FY END ASC, 
CASE WHEN @SortExpression='TBSFY DESC' THEN dbo.TBS.FY END DESC, 
CASE WHEN @SortExpression='Disposi.on' THEN SD.DISPOSITION_DESCRIPTION END ASC, 
CASE WHEN @SortExpression='Disposi.on DESC' THEN SD.DISPOSITION_DESCRIPTION END DESC, 
CASE WHEN @SortExpression='OSS' THEN OSS.SHORT_NAME END ASC, 
CASE WHEN @SortExpression='OSS DESC' THEN OSS.SHORT_NAME END DESC]]></body>
<schema>E9C4E37D-78A2-31F9-D580-7C2848ACFCB7</schema>
<database>EA42DEDC-DFC5-B775-3079-AD0E133F5E1D</database>
</StoredProcedureSqlServerv2k5>