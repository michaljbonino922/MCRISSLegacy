<?xml version = '1.0' encoding = 'UTF-8'?>
<StoredProcedureSqlServerv2k5 class="oracle.dbtools.crest.model.design.storage.sqlserver.v2k5.StoredProcedureSqlServerv2k5" name="[GetCommissioneeViewForDistrict]" directorySegmentName="seg_4" id="D7A7716A-38F2-BF69-C644-3FEED31E003A">
<sourceDDLFile>Appian.sql</sourceDDLFile>
<createdBy>MichalBonino</createdBy>
<createdTime>2024-04-29 23:57:48 UTC</createdTime>
<ownerDesignName>MCRISSLegacy</ownerDesignName>
<body><![CDATA[@FromDate date.me, 
 @ToDate  date.me, 
 @District int, 
 @OSS  int = NULL, 
 @SortExpression nvarchar(100) = 'CommissionDate' 
AS 
 
SELECT      
 P.PERSON_ID,  
 N.NWA_ID,  
 OC.CONTRACT_ID,  
 C.COMMISSIONEE_ID,  
 P.LAST_NAME + ', ' + P.FIRST_NAME + COALESCE (SPACE(1)  
                      + P.LEGAL_MIDDLE_NAME, SPACE(0)) AS PERSON_NAME,  
 P.SOCIAL_SECURITY_NUMBER AS SSN,  
 MC.GENDER_CODE AS GENDER,  
 C.COMMISSION_DATE,  
 dbo.TBS.CLASS AS TBS_CLASS,  
 dbo.TBS.FY AS TBS_FY,  
 SD.STATUS_DESCRIPTION AS STATUS,  
 SD.DISPOSITION_DESCRIPTION AS DISPOSITION,  
 OSS.ORGANIZATION_ID AS Organiza.onOfRecordID,  
 OSS.SHORT_NAME AS Organiza.onOfRecordName 
FROM          
 dbo.RECRUITING_ORGANIZATION AS DIST WITH (NOLOCK) INNER JOIN 
 dbo.ORGANIZATION_MAP AS RS_M ON DIST.ORGANIZATION_ID = @District AND  
         DIST.ORGANIZATION_ID = RS_M.PARENT_ORGANIZATION_ID INNER JOIN 
 dbo.ORGANIZATION_MAP AS OSS_M ON RS_M.CHILD_ORGANIZATION_ID = OSS_M.PARENT_ORGANIZATION_ID AND  
          OSS_M.CHILD_ORGANIZATION_ID = COALESCE (@OSS, OSS_M.CHILD_ORGANIZATION_ID) INNER JOIN 
 dbo.RECRUITING_ORGANIZATION AS OSS ON OSS_M.CHILD_ORGANIZATION_ID = OSS.ORGANIZATION_ID INNER JOIN 
 dbo.NWA AS N ON N.ORGANIZATION_OF_RECORD_ID = OSS_M.CHILD_ORGANIZATION_ID INNER JOIN 
 dbo.OFFICER_CONTRACT AS OC ON N.NWA_ID = OC.NWA_ID INNER JOIN 
 dbo.COMMISSIONEE AS C ON OC.CONTRACT_ID = C.CONTRACT_ID AND  
        C.COMMISSION_DATE BETWEEN @FromDate AND @ToDate INNER JOIN 
 dbo.PERSON AS P ON N.MARINE_CANDIDATE_ID = P.PERSON_ID INNER JOIN 
 dbo.MARINE_CANDIDATE AS MC ON P.PERSON_ID = MC.MARINE_CANDIDATE_ID INNER JOIN 
 dbo.CANDIDATE_STATUS AS CS ON N.NWA_ID = CS.NWA_ID AND CS.STATUS_TYPE = 'O' AND  
          CS.CANDIDATE_STATUS_ID = USMC.GetMaxStatusID(CS.NWA_ID) INNER JOIN 
 dbo.STATUS_DISPOSITION AS SD ON CS.STATUS_TYPE = SD.STATUS_TYPE AND  
         CS.STATUS_CODE = SD.STATUS_CODE AND  
         CS.DISPOSITION_CODE = SD.DISPOSITION_CODE LEFT OUTER JOIN 
 dbo.PRECOMMISSION_DATA AS PCD ON OC.NWA_ID = PCD.NWA_ID LEFT OUTER JOIN 
 dbo.TBS ON PCD.TBS_ID = dbo.TBS.TBS_ID 
ORDER BY  
CASE WHEN @SortExpression='PersonName' THEN P.LAST_NAME + ', ' + P.FIRST_NAME END ASC, 
CASE WHEN @SortExpression='PersonName DESC' THEN P.LAST_NAME + ', ' + P.FIRST_NAME END DESC, 
CASE WHEN @SortExpression='CommissionDate' THEN C.COMMISSION_DATE END ASC, 
CASE WHEN @SortExpression='CommissionDate DESC' THEN C.COMMISSION_DATE END DESC, 
CASE WHEN @SortExpression='TBSClass' THEN dbo.TBS.CLASS END ASC, 
CASE WHEN @SortExpression='TBSClass DESC' THEN dbo.TBS.CLASS END DESC, 
CASE WHEN @SortExpression='TBSFY' THEN dbo.TBS.FY END ASC, 
CASE WHEN @SortExpression='TBSFY DESC' THEN dbo.TBS.FY END DESC, 
CASE WHEN @SortExpression='Disposi.on' THEN SD.DISPOSITION_DESCRIPTION END ASC, 
CASE WHEN @SortExpression='Disposi.on DESC' THEN SD.DISPOSITION_DESCRIPTION END DESC, 
CASE WHEN @SortExpression='OSS' THEN OSS.SHORT_NAME END ASC, 
CASE WHEN @SortExpression='OSS DESC' THEN OSS.SHORT_NAME END DESC]]></body>
<schema>E9C4E37D-78A2-31F9-D580-7C2848ACFCB7</schema>
<database>EA42DEDC-DFC5-B775-3079-AD0E133F5E1D</database>
</StoredProcedureSqlServerv2k5>