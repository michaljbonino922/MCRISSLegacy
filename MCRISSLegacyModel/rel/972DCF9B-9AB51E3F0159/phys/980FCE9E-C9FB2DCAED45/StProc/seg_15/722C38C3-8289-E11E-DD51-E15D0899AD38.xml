<?xml version = '1.0' encoding = 'UTF-8'?>
<StoredProcedureSqlServerv2k5 class="oracle.dbtools.crest.model.design.storage.sqlserver.v2k5.StoredProcedureSqlServerv2k5" name="[InsertUpdateProfessedNonMepsExam]" directorySegmentName="seg_15" id="722C38C3-8289-E11E-DD51-E15D0899AD38">
<sourceDDLFile>create ODSE script - MCRISS OTA.txt</sourceDDLFile>
<createdBy>MichalBonino</createdBy>
<createdTime>2024-04-29 23:43:56 UTC</createdTime>
<ownerDesignName>MCRISSLegacyModel</ownerDesignName>
<body><![CDATA[@ID uniqueiden..er, 
 @ProspectID uniqueiden..er, 
 @ExamType char(1), 
 @ExamDate date.me, 
 @ExamEnteredDate date.me, 
 @Score int, 
 @CareerDecision varchar(25), 
 @LastUpdateBy uniqueiden..er, 
 @PiCatMmScore int = null, 
 @PiCatGtScore int = null, 
 @PiCatElScore int = null, 
 @PiCatClScore int = null  
 
AS 
BEGIN 
 
 -- STEP 1: Start the transac.on 
 BEGIN TRANSACTION 
 
 -- STEP 2 & 3: Issue the data change statement(s), checking @@ERROR a.er each statement 
 IF EXISTS(SELECT ID FROM USMC.ProspectNonMEPSProfessedExam WHERE ID = @ID) 
 BEGIN 
  -- if already exists.  UPDATE. 
  UPDATE USMC.ProspectNonMEPSProfessedExam 
  SET  
   ExamType = @ExamType 
   ,ExamDate = @ExamDate 
   ,ExamEnteredDate = @ExamEnteredDate 
   ,Score = @Score 
   ,CareerDecision = @CareerDecision 
   ,LastUpdateDate = GETDATE() 
   ,LastUpdateBy = @LastUpdateBy 
   ,PiCatMmScore = @PiCatMmScore 
   ,PiCatGtScore = @PiCatGtScore 
   ,PiCatElScore = @PiCatElScore 
   ,PiCatClScore = @PiCatClScore 
    
  WHERE ID = @ID 
    
 END 
 ELSE 
 BEGIN 
  -- if does not exist.  INSERT. 
  INSERT INTO USMC.ProspectNonMEPSProfessedExam 
           (ID 
           ,ProspectID 
           ,ExamType 
           ,ExamDate 
           ,ExamEnteredDate 
           ,Score 
     ,CareerDecision 
     ,PiCatMmScore 
           ,PiCatGtScore 
           ,PiCatElScore 
           ,PiCatClScore 
           ,LastUpdateDate 
           ,LastUpdateBy) 
     VALUES 
           (@ID 
           ,@ProspectID 
           ,@ExamType 
           ,@ExamDate 
           ,@ExamEnteredDate 
           ,@Score 
     ,@CareerDecision 
     ,@PiCatMmScore 
     ,@PiCatGtScore 
     ,@PiCatElScore 
     ,@PiCatClScore 
           ,GETDATE() 
           ,@LastUpdateBy) 
 END 
 
 -- Rollback the transac.on if there were any errors 
 IF @@ERROR <> 0 
 BEGIN 
  -- Rollback the transac.on 
  ROLLBACK TRANSACTION 
 
  -- Raise an error and return 
  RAISERROR ('Error occurred while performing the change.', 16, 1) 
  RETURN 
 END 
 
 -- Rollback the transac.on if the number of rows changed does not meet our expecta.on... 
 IF @@ROWCOUNT > 1 
 BEGIN 
  -- Rollback the transac.on 
  ROLLBACK TRANSACTION 
 
  -- Raise an error and return 
  RAISERROR ('An unexpected number of rows were changed.', 16, 1) 
  RETURN 
 END 
  
 -- STEP 4: If we reach this point, the commands completed successfully 
 --         Commit the transac.on.... 
 COMMIT TRANSACTION 
  
END]]></body>
<schema>A5B5C85F-7BA3-158E-D5A2-943767AC9AE2</schema>
<database>5DE69EDC-7A85-C77A-928E-DB3F41DD97CF</database>
</StoredProcedureSqlServerv2k5>