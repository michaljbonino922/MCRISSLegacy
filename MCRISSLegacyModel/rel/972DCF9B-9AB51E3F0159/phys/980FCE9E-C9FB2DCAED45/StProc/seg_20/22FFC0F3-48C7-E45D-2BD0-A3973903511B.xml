<?xml version = '1.0' encoding = 'UTF-8'?>
<StoredProcedureSqlServerv2k5 class="oracle.dbtools.crest.model.design.storage.sqlserver.v2k5.StoredProcedureSqlServerv2k5" name="[sp_GetPriorServicesHistory]" directorySegmentName="seg_20" id="22FFC0F3-48C7-E45D-2BD0-A3973903511B">
<sourceDDLFile>Appian.sql</sourceDDLFile>
<createdBy>MichalBonino</createdBy>
<createdTime>2024-04-29 23:57:48 UTC</createdTime>
<ownerDesignName>MCRISSLegacyModel</ownerDesignName>
<body><![CDATA[@PersonId int 
AS 
 
SELECT  
 CONVERT(CHAR(11), CPS.BEGIN_DATE, 106) AS BEGIN_DATE, 
 CONVERT(CHAR(11), CPS.END_DATE, 106) AS END_DATE, 
 CC.COMPONENT_DESCRIPTION AS COMPONENT_CODE, 
 CPS.SERVICE_CHARACTER, 
 CPS.SEPARATION_CODE, 
 CPS.REENLISTMENT_CODE, 
 COALESCE(CPS.VERIFICATION, SPACE(0)) AS RECORD_STATUS, 
 COALESCE(CONVERT(VARCHAR(2), CPS.SERVICE_ID), SPACE(0)) AS SERVICE_ID, 
 COALESCE(S.SERVICE, SPACE(0)) AS SERVICE, 
 COALESCE(CPS.CURRENTLY_IN_RESERVES, SPACE(0)) AS CURRENTLY_IN_RESERVES, 
  COALESCE(CONVERT(CHAR(11), CPS.END_OF_OBLIGATED_SERVICE_DATE, 106), SPACE(0)) AS END_OF_OBLIGATED_SERVICE_DATE, 
 COALESCE(CPS.COMPONENT_CODE, (SELECT TOP 1 N.OFFICER_COMPONENT_CODE FROM NWA N 
     WHERE N.MARINE_CANDIDATE_ID = @PersonID 
     ORDER BY N.NWA_ID DESC), SPACE(0)) AS COMPONENT_CODE 
FROM  
 CANDIDATE_PRIOR_SERVICE CPS INNER JOIN COMPONENT_CODE CC ON  
  (CPS.MARINE_CANDIDATE_ID = @PersonId AND  
  CPS.COMPONENT_CODE = CC.COMPONENT_CODE) 
 LEFT OUTER JOIN SERVICE S ON CPS.SERVICE_ID = S.SERVICE_ID]]></body>
<schema>DD6CF638-A2EB-2E1B-FF13-422CA718DE2D</schema>
<database>EA42DEDC-DFC5-B775-3079-AD0E133F5E1D</database>
</StoredProcedureSqlServerv2k5>