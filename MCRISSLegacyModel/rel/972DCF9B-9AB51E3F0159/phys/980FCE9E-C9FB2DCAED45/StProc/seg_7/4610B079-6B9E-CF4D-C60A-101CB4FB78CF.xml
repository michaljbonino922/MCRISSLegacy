<?xml version = '1.0' encoding = 'UTF-8'?>
<StoredProcedureSqlServerv2k5 class="oracle.dbtools.crest.model.design.storage.sqlserver.v2k5.StoredProcedureSqlServerv2k5" name="[GetNwasProjectedToShipInMonth]" directorySegmentName="seg_7" id="4610B079-6B9E-CF4D-C60A-101CB4FB78CF">
<sourceDDLFile>create MCRISS script - MCRISS OTA.txt</sourceDDLFile>
<createdBy>MichalBonino</createdBy>
<createdTime>2024-04-29 19:28:42 UTC</createdTime>
<ownerDesignName>MCRISSLegacyModel</ownerDesignName>
<body><![CDATA[(@BeginDate date.me 
 ,@OrgId int) 
AS 
 
SET NOCOUNT ON 
 
SELECT  
  n.[MARINE_CANDIDATE_ID] as PersonID 
 ,n.[NWA_ID] 
 ,n.[NWA_DECLARED_DATE] 
 ,n.[NWA_DATE_STARTED_WORKING] 
 ,n.[PARENTAL_CONSENT] 
 ,n.[PROJECTED_SHIP_MONTH] 
 ,n.[NWA_LOG_NOTES] 
 ,n.[PROJECTED_PROG_CHOICE1] 
 ,n.[PROJECTED_PROG_CHOICE2] 
 ,n.[PROJECTED_PROG_CHOICE3] 
 ,n.[ACTIVITY_CODE] 
 ,n.[SOURCE_CODE] 
 ,n.[SOURCE_CODE_DUAL] 
 ,n.[RECRUITER_OF_RECORD_ID] 
 ,n.[ORGANIZATION_OF_RECORD_ID] 
 ,n.[WORKING_RECRUITER_ID] 
 ,n.[CATEGORY_CODE] 
 ,n.[EDUCATION_LEVEL] 
 ,n.[EDUCATION_CODE] 
 ,n.[PPC] 
 ,n.[COMP_CHANGE_FLAG] 
 ,n.[BACH_GRAD_YEAR] 
 ,n.[USER_LOGIN] 
 ,n.[UPDATE_DATE] 
 ,n.[rowguid] 
 ,n.[OFFICER_COMPONENT_CODE] 
 ,n.[SHIP_MISSION] 
 ,n.[EMAIL_ADDRESS] 
 ,n.[RAPP_ISSUE_DATE] 
 ,n.[RAPP_SUBMIT_DATE] 
 ,n.[BACH_GRAD_MONTH] 
 ,n.[NATIONAL_CALL_TO_SERVICE] 
 ,n.[OCCR] 
 ,COALESCE(RTRIM(RP.RANK_CODE), SPACE(0)) + SPACE(1)  +  
  COALESCE(RTRIM(RCRTR.LAST_NAME), SPACE(0))  + SPACE(1) +  
  COALESCE(RTRIM(RCRTR.FIRST_NAME), SPACE(0)) + SPACE(1) +  
  COALESCE(RTRIM(RCRTR.LEGAL_MIDDLE_NAME), SPACE(0)) AS RECRUITER_OF_RECORD_NAME       
 ,[OFC_NWA_LOG_NOTE] 
FROM  
 [dbo].[NWA] n WITH (NOLOCK) 
INNER JOIN [dbo].[CONTRACT] c 
 ON c.NWA_ID = n.NWA_ID 
LEFT JOIN [dbo].[RECRUITING_PERSON] RP  
 ON RP.RECRUITING_PERSON_ID = n.RECRUITER_OF_RECORD_ID 
LEFT JOIN [dbo].[PERSON] RCRTR  
 ON RP.RECRUITING_PERSON_ID = RCRTR.PERSON_ID  
WHERE 
 c.PROJECTED_SHIP_DATE BETWEEN @BeginDate AND DATEADD(d, -1, DATEADD(m, 1, @BeginDate)) AND 
 n.ORGANIZATION_OF_RECORD_ID = @OrgId]]></body>
<schema>72379847-5555-B149-4E45-17F849103A51</schema>
<database>B007042D-D2E3-F83F-481F-CEB23B21CB30</database>
</StoredProcedureSqlServerv2k5>