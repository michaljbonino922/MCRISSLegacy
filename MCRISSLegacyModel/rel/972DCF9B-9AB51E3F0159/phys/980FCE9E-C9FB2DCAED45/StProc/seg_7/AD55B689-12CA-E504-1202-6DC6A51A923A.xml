<?xml version = '1.0' encoding = 'UTF-8'?>
<StoredProcedureSqlServerv2k5 class="oracle.dbtools.crest.model.design.storage.sqlserver.v2k5.StoredProcedureSqlServerv2k5" name="[GetOCSHistory]" directorySegmentName="seg_7" id="AD55B689-12CA-E504-1202-6DC6A51A923A">
<sourceDDLFile>create MCRISS script - MCRISS OTA.txt</sourceDDLFile>
<createdBy>MichalBonino</createdBy>
<createdTime>2024-04-29 19:28:42 UTC</createdTime>
<ownerDesignName>MCRISSLegacyModel</ownerDesignName>
<body><![CDATA[@NWAID int 
AS 
 
SELECT 
 O.OCS_ID, 
 COALESCE(CONVERT(VARCHAR(11), O.SCHEDULED_SHIP_DATE, 106), 'NOT SCHEDULED YET') AS SCHEDULED_SHIP_DATE, 
 C.TRAINING_TYPE_CODE AS TRAINING_TYPE, 
 C.CLASS_NUMBER, 
 C.TRAINING_TYPE_CODE, 
 C.CLASS_NUMBER AS CLASS_INCREMENT, 
 CONVERT(CHAR(11), O.REPORT_DATE, 106) AS REPORT_DATE, 
 R.RESULT_DESCRIPTION, 
 COALESCE(CONVERT(VARCHAR(2), O.TRAINING_DROP_WEEK), SPACE(0)) AS TRAINING_DROP_WEEK 
FROM 
 OCS O WITH (NOLOCK) 
 INNER JOIN OCS_CLASS C ON  
  (O.OCS_CLASS_ID = C.CLASS_ID AND 
  O.NWA_ID = @NWAID AND 
  (O.DISPLAY_RECORD = 'Y' OR 
  C.TRAINING_TYPE_CODE = 'PLCSR' AND  
  EXISTS (SELECT 1 FROM OCS O1 INNER JOIN OCS_CLASS C1 ON  
    (O1.OCS_CLASS_ID = C1.CLASS_ID AND  
    O1.NWA_ID = @NWAID AND 
    C1.TRAINING_TYPE_CODE = 'PLCJR' AND 
    O1.DISPLAY_RECORD = 'Y' AND 
    O1.OCS_ID < O.OCS_ID))))  
 LEFT OUTER JOIN OCS_CLASS_RESULT R ON O.CLASS_RESULT_CODE = R.RESULT_CODE 
ORDER BY  
 O.OCS_ID DESC]]></body>
<schema>72379847-5555-B149-4E45-17F849103A51</schema>
<database>B007042D-D2E3-F83F-481F-CEB23B21CB30</database>
</StoredProcedureSqlServerv2k5>