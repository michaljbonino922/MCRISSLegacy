<?xml version = '1.0' encoding = 'UTF-8'?>
<StoredProcedureSqlServerv2k5 class="oracle.dbtools.crest.model.design.storage.sqlserver.v2k5.StoredProcedureSqlServerv2k5" name="[SPGEN_CANDLANGUAGE]" directorySegmentName="seg_26" id="B49251D1-BC70-3DEC-52F5-6C624681D467">
<sourceDDLFile>create MCRISS script - MCRISS OTA.txt</sourceDDLFile>
<createdBy>MichalBonino</createdBy>
<createdTime>2024-04-29 19:28:42 UTC</createdTime>
<ownerDesignName>MCRISSLegacyModel</ownerDesignName>
<body><![CDATA[as  
SET ARITHABORT OFF 
set arithignore on 
set ansi_warnings o. 
declare  
 @ssn     varchar(9), 
 @marine_candidate_id   int, 
 @person_id    int, 
 @forgn_lang_code_1   varchar(2), 
 @forgn_lang_code_2   varchar(2), 
 @forgn_lang_code_3   varchar(2), 
 @user_login   varchar(15), 
 @update_date   date.me 
 
 
declare language cursor for 
 
select   SSN,  
  FORGN_LANG_CODE_1,  
  FORGN_LANG_CODE_2,  
  FORGN_LANG_CODE_3 
 
from arms..ARMS179 
 
 
open language 
 
fetch language  
    into @ssn, @forgn_lang_code_1, @forgn_lang_code_2, @forgn_lang_code_3 
 
while (@@FETCH_STATUS = 0) 
begin 
 
select @user_login = 'migra.on' 
select @update_date = getdate() 
 
     select @person_id =  PERSON_ID from PERSON  
     where PERSON.SOCIAL_SECURITY_NUMBER = @ssn  
 
     if @person_id is not NULL 
       begin  
 
    print @ssn 
 
       if (not exists(select 1 from mcriss..CANDIDATE_LANGUAGE 
                 where MARINE_CANDIDATE_ID = @person_id)) 
      begin 
     if @forgn_lang_code_1 not like '' 
      begin 
    insert into mcriss..CANDIDATE_LANGUAGE 
    (MARINE_CANDIDATE_ID,LANGUAGE_CODE,USER_LOGIN,UPDATE_DATE) 
     
 
    values(@person_id, @forgn_lang_code_1,@user_login,@update_date) 
   print @ssn +'File1 added to Candidate_language' 
   end 
     if @forgn_lang_code_2 not like '' 
      begin 
    insert into mcriss..CANDIDATE_LANGUAGE 
    (MARINE_CANDIDATE_ID,LANGUAGE_CODE,USER_LOGIN,UPDATE_DATE) 
 
    values(@person_id, @forgn_lang_code_2,@user_login,@update_date) 
   print @ssn +'File2 added to Candidate_language' 
   end 
     if @forgn_lang_code_3 not like '' 
      begin 
    insert into mcriss..CANDIDATE_LANGUAGE 
    (MARINE_CANDIDATE_ID,LANGUAGE_CODE,USER_LOGIN,UPDATE_DATE) 
 
    values(@person_id, @forgn_lang_code_3,@user_login,@update_date) 
   print @ssn +'File3 added to Candidate_language' 
   end 
         end 
       else 
         begin 
     if @forgn_lang_code_1 not like '' 
      begin 
    update mcriss..CANDIDATE_LANGUAGE 
     set LANGUAGE_CODE = @forgn_lang_code_1 
    where MARINE_CANDIDATE_ID = @person_id 
   print @ssn +'File1 updated to Candidate_language' 
   end 
     if @forgn_lang_code_2 not like '' 
      begin 
    update mcriss..CANDIDATE_LANGUAGE 
     set LANGUAGE_CODE = @forgn_lang_code_2 
    where MARINE_CANDIDATE_ID = @person_id 
   print @ssn +'File2 updated to Candidate_language' 
   end 
     if @forgn_lang_code_3 not like '' 
      begin 
    update mcriss..CANDIDATE_LANGUAGE 
     set LANGUAGE_CODE = @forgn_lang_code_3 
    where MARINE_CANDIDATE_ID = @person_id 
   print @ssn +'File3 updated to Candidate_language' 
   end 
        end 
   
   print @ssn+' Does not have a Language' 
      end 
      else 
        print @ssn+' Not in person' 
 
   fetch language  
    into @ssn, @forgn_lang_code_1, @forgn_lang_code_2, @forgn_lang_code_3 
 
end 
 
close language 
 
deallocate language]]></body>
<schema>3925E19F-DC76-90A4-B892-D7A526C79632</schema>
<database>B007042D-D2E3-F83F-481F-CEB23B21CB30</database>
</StoredProcedureSqlServerv2k5>