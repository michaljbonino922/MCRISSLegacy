<?xml version = '1.0' encoding = 'UTF-8'?>
<StoredProcedureSqlServerv2k5 class="oracle.dbtools.crest.model.design.storage.sqlserver.v2k5.StoredProcedureSqlServerv2k5" name="[UpdatePersonnelBillet]" directorySegmentName="seg_27" id="AD7465E9-FC47-8681-FDEF-54F042E4A48E">
<sourceDDLFile>Appian.sql</sourceDDLFile>
<createdBy>MichalBonino</createdBy>
<createdTime>2024-04-29 23:57:49 UTC</createdTime>
<ownerDesignName>MCRISSLegacyModel</ownerDesignName>
<body><![CDATA[@PersonID int, 
 @Recrui.ngRoleID varchar(2), 
 @BilletBeginDate date.me, 
 @UserLogin varchar(15) 
AS 
 
SET NOCOUNT ON 
 
DECLARE @MaxBilletBeginDate date.me 
SELECT @MaxBilletBeginDate = MAX(BILLET_BEGIN_DATE) FROM Recruiter_History WHERE Recrui.ng_Person_Id = @PersonId 
 
DECLARE @MaxBilletEndDate date.me 
SELECT @MaxBilletEndDate = MAX(BILLET_END_DATE) FROM Recruiter_History WHERE Recrui.ng_Person_Id = @PersonId 
 
DECLARE @BeginDate date.me 
SELECT @BeginDate = BILLET_BEGIN_DATE FROM RECRUITING_PERSON WHERE RECRUITING_PERSON_ID = @PersonId 
 
IF @BeginDate != @BilletBeginDate 
BEGIN 
 DECLARE @ShortDescrip.on varchar(15) 
 SELECT @ShortDescrip.on = rr.Short_Descrip.on FROM Recrui.ng_Person rp, Recrui.ng_Role rr WHERE rp.Recrui.ng_Person_Id = @PersonId and rp.Recrui.ng_Role_id = rr.Recrui.ng_Role_Id 
  
 EXEC sp_InsertRecruiterHistory  
  @PersonId = @PersonId,  
  @BeginDate = @BeginDate,  
  @BilletEndDate = @BilletBeginDate,  
  @ShortDescrip.on = @ShortDescrip.on,  
  @UserLogin = @UserLogin 
  
 UPDATE RECRUITING_PERSON  
 SET  
  RECRUITING_ROLE_ID = @Recrui.ngRoleID,  
  BILLET_BEGIN_DATE = @BilletBeginDate,  
  USER_LOGIN = @UserLogin,  
  UPDATE_DATE = GETDATE()  
 WHERE  
  RECRUITING_PERSON_ID = @PersonID 
END 
 
SET NOCOUNT OFF]]></body>
<schema>E9C4E37D-78A2-31F9-D580-7C2848ACFCB7</schema>
<database>EA42DEDC-DFC5-B775-3079-AD0E133F5E1D</database>
</StoredProcedureSqlServerv2k5>