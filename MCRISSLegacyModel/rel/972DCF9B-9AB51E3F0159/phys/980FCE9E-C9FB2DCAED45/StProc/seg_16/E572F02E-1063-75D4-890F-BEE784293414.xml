<?xml version = '1.0' encoding = 'UTF-8'?>
<StoredProcedureSqlServerv2k5 class="oracle.dbtools.crest.model.design.storage.sqlserver.v2k5.StoredProcedureSqlServerv2k5" name="[sp_GetCommissionee]" directorySegmentName="seg_16" id="E572F02E-1063-75D4-890F-BEE784293414">
<sourceDDLFile>Appian.sql</sourceDDLFile>
<createdBy>MichalBonino</createdBy>
<createdTime>2024-04-29 23:57:47 UTC</createdTime>
<ownerDesignName>MCRISSLegacyModel</ownerDesignName>
<body><![CDATA[@ContractID int 
AS 
 
SELECT   
 COALESCE(C.COMMISSIONEE_ID, 0) AS COMMISSIONEE_ID, 
 COALESCE(CONVERT(CHAR(11), C.COMMISSION_DATE, 106), SPACE(0)) AS COMMISSION_DATE, 
 COALESCE(CONVERT(VARCHAR(2), TBS.CLASS), SPACE(0)) AS TBS_CLASS, 
 COALESCE(CONVERT(VARCHAR(4), TBS.FY), SPACE(0)) AS TBS_FY, 
 COALESCE(P.FY_ACTIVE_DUTY_ASSIGNMENT, 0) AS FY_ACTIVE_DUTY_ASSIGNMENT, 
 COALESCE(CONVERT(CHAR(11), P.PROJ_LAW_GRAD_DATE, 106), SPACE(0)) AS PROJ_LAW_GRAD_DATE,  
 COALESCE(B1.BAR_ID, 0) AS FIRST_BAR_ID, 
 COALESCE(CONVERT(CHAR(11), B1.SCHEDULED_BAR_DATE, 106), SPACE(0)) AS FIRST_SCHEDULED_BAR_DATE, 
 COALESCE(B1.BAR_ADMISSION_STATUS, SPACE(0)) AS FIRST_BAR_ADMISSION_STATUS, 
 COALESCE(B2.BAR_ID, 0) AS SECOND_BAR_ID, 
 COALESCE(CONVERT(CHAR(11), B2.SCHEDULED_BAR_DATE, 106), SPACE(0))  AS SECOND_SCHEDULED_BAR_DATE, 
 COALESCE(B2.BAR_ADMISSION_STATUS, SPACE(0)) AS SECOND_BAR_ADMISSION_STATUS, 
 COALESCE(BAS.BAR_ADMISSION_DESCRIPTION, SPACE(0)) AS BAR_ADMISSION_DESCRIPTION, 
 COALESCE(P.FLIGHT_INDOCTRINATION, 'N') AS FLIGHT_INDOCTRINATION, 
 COALESCE(P.PRIVATE_PILOT, 'N') AS PRIVATE_PILOT, 
 COALESCE(P.FLIGHT_HOURS, 0) AS FLIGHT_HOURS, 
 COALESCE(P.CERTIFIED_CROSS_COUNTRY, 'N') AS CERTIFIED_CROSS_COUNTRY, 
 COALESCE(CONVERT(CHAR(11), P.REQUEST_FOR_APPOINTMENT_DATE, 106), SPACE(0)) AS REQUEST_FOR_APPOINTMENT_DATE, 
 COALESCE(CONVERT(CHAR(11), MR.MCRC_RECEIVED_DATE, 106), SPACE(0)) AS MCRC_RECEIVED_DATE, 
 COALESCE(CONVERT(CHAR(11), OA.ACCESSION_DATE, 106), SPACE(0)) AS ACCESSION_DATE 
FROM  
 OFFICER_CONTRACT OC INNER JOIN NWA N ON  
  (OC.NWA_ID = N.NWA_ID AND 
  OC.CONTRACT_ID = @ContractID) 
 LEFT OUTER JOIN COMMISSIONEE C ON OC.CONTRACT_ID = C.CONTRACT_ID  
 LEFT OUTER JOIN PRECOMMISSION_DATA P ON OC.NWA_ID = P.NWA_ID 
 LEFT OUTER JOIN TBS ON P.TBS_ID = TBS.TBS_ID 
 LEFT OUTER JOIN RFA_TRACKING_DATES MR ON OC.CONTRACT_ID = MR.CONTRACT_ID 
 LEFT OUTER JOIN BAR B1 ON  
  (N.MARINE_CANDIDATE_ID = B1.MARINE_CANDIDATE_ID AND 
  B1.BAR_ID = (SELECT MAX(B.BAR_ID) FROM BAR B 
    WHERE B.MARINE_CANDIDATE_ID = B1.MARINE_CANDIDATE_ID)) 
 LEFT OUTER JOIN BAR B2 ON  
  (N.MARINE_CANDIDATE_ID = B2.MARINE_CANDIDATE_ID AND 
  B2.BAR_ID = (SELECT MAX(B.BAR_ID) FROM BAR B 
    WHERE B.MARINE_CANDIDATE_ID = B2.MARINE_CANDIDATE_ID AND 
    B.BAR_ID < B1.BAR_ID)) 
 LEFT OUTER JOIN BAR_ADMISSION_STATUS BAS ON COALESCE(B2.BAR_ADMISSION_STATUS, B1.BAR_ADMISSION_STATUS, SPACE(0)) = BAS.BAR_ADMISSION_STATUS_CODE 
 LEFT OUTER JOIN OFFICER_ACCESSION OA ON OC.NWA_ID = OA.NWA_ID]]></body>
<schema>DD6CF638-A2EB-2E1B-FF13-422CA718DE2D</schema>
<database>EA42DEDC-DFC5-B775-3079-AD0E133F5E1D</database>
</StoredProcedureSqlServerv2k5>